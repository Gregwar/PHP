TD6-1: Installation de Symfony
==============================

Au cours de ce TP en plusieurs parties, nous allons créer une application de gestion de commande de pizzas.

.. slide::

Installation de Symfony
-----------------------

.. step::
    Etape 1: récupérer les fichiers
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    La meilleure solution afin d'installer Symfony est de passer par composer. Pour cela,
    installez tout d'abord composer quelque part et utilisez la commande ``create-project``:

    .. code-block:: no-highlight
        composer create-project symfony/skeleton pizza "3.4.*" -s dev 

    Composer va alors cloner le squelette du framework Symfony dans le dossier ``pizza/``.

.. slide::

.. step::

    Etape 2: lancement du serveur
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    Lancez la commande::

        php -S localhost:8000 -t public

    Et connectez vous à ``http://localhost:8000/``, vous devriez voir la page d'erreur
    ``404`` par défaut de Symfony:

.. slide::

.. center::
    .. image:: /img/sf404.png

.. slide::

.. step::

    Symfony vient avec son propre outil en ligne de commande, vous pouvez l'exécuter
    pour voir les commandes disponibles::

        ./bin/console

    Nous allons installer notre premier composant Symfony: un meilleur serveur web
    de développement. Pour cela, lancez simplement::

        composer require symfony/web-server-bundle

    Si vous exécutez à nouveau la console de Symfony, vous verrez qu'une nouvelle option
    est maintenant disponible, ``server:run``, vous pouvez donc désormais lancer le
    serveur de développement de cette façon::

        ./bin/console server:run

.. slide::

.. step::

    Etape 3: créer votre Contrôleur
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

    Votre application réside dans le dossier ``src/``. Par défaut, Symfony ne contient
    aucun contrôleur. Créez le fichier ``src/Controller/DefaultController.php``:: 

        // src/Controller/DefaultController.php
        namespace App\Controller;

        use Symfony\Component\HttpFoundation\Response;
        use Symfony\Component\Routing\Annotation\Route;

        class DefaultController
        {
            /**
             * @Route("/")
             */
            public function indexAction()
            {
                return new Response(
                    '<html><body>Hello world!</body></html>'
                );
            }
        }

.. slide::

.. step::

    Etape 4: Route
    ~~~~~~~~~~~~~~~~~~~~
    
    Dans le fichier ``config/routes.yaml``, vous trouverez une règle permettant d'importer
    les *annotations* depuis vos contrôleurs. Cependant, il faut d'abord installer le module
    qui lit les annotations::

        composer req annotations

    Ensuite, décommentez les dernières lignes du fichier ``routes.yaml``, et chargez votre
    première page!

